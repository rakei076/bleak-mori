# 黑暗森林 - 暗黑森林策略游戏

一款受黑暗森林三部曲启发的单人网页策略游戏。通过管理资源、探索太空和保持低暴露度来在敌对宇宙中生存，避免被AI检测。

## 🎮 游戏概述

在这款黑暗森林风格的游戏中，你必须：
- **探索** 使用脉冲和深度探测器探索星图
- **殖民** 殖民星球以增加资源产量
- **打击** 消灭敌对势力
- **生存** 保持低暴露度以避免AI检测

核心机制：**保持隐蔽，否则被摧毁。**

## 🚀 功能特性

### 核心系统
- ✅ **星图生成**：250+个随机分布的不同类型星球
- ✅ **情报系统**：4阶段星球可见度（未知 → 已知 → 已扫描 → 已分析）
- ✅ **探测系统**：
  - **脉冲探测器**：快速、短程、低暴露
  - **深度探测器**：缓慢、远程、高暴露
- ✅ **资源管理**：能量、材料和算力生产
- ✅ **暴露系统**：行动增加暴露度，随时间衰减
- ✅ **殖民系统**：占领星球获取资源生产
- ✅ **打击系统**：发射攻击，包含飞行时间和撞击解算
- ✅ **AI对手**：2个AI玩家会根据你的暴露度进行检测和打击
- ✅ **科技系统**：为未来升级预留的占位符

### 界面/图形
- ✅ **画布渲染**：带颜色编码的星图
  - 灰色：未知星球
  - 浅色：已知/已扫描星球
  - 绿色：玩家殖民地
  - 红色：AI殖民地
- ✅ **资源面板**：实时显示资源和状态
- ✅ **操作按钮**：快速发射探测器
- ✅ **事件日志**：追踪所有游戏事件
- ✅ **星球弹窗**：点击星球查看信息并执行操作

## 🎯 如何游玩

### 开始游戏
1. 你从一个殖民地开始，每个时刻（800毫秒）产生资源
2. 资源累积：能量、材料和算力
3. 你的暴露度从0开始 - 保持低位！

### 操作

**发射探测器**
- 点击"脉冲扫描"（消耗：10能量）- 小范围，3时刻，+5暴露度
- 点击"深度扫描"（消耗：50能量）- 大范围，8时刻，+20暴露度
- 探测器揭示范围内的星球信息

**殖民星球**
- 点击已扫描/已分析的中立星球
- 消耗：50能量 + 30材料
- 增加产量但提高基础暴露度

**发射打击**
- 点击敌对星球（AI拥有或敌对的）
- 消耗：80能量 + 40材料
- 10时刻飞行时间
- 增加+30暴露度（非常危险！）

### 策略提示
1. **管理暴露度**：高暴露度吸引AI打击
2. **谨慎扩张**：每个殖民地增加产量但也增加暴露度
3. **明智侦察**：脉冲扫描比深度扫描更安全
4. **节制打击**：攻击会产生大量暴露度峰值

### 游戏结束
- 失去所有殖民地 = 游戏结束
- AI打击基于你的暴露度水平和它们的侵略性

## 🛠️ 开发

### 安装
```bash
npm install
```

### 运行开发服务器
```bash
npm run dev
```
打开 http://localhost:5173

### 构建生产版本
```bash
npm run build
```

## 📁 项目结构

```
src/
├── constants.ts          # 所有游戏常量和魔术数字
├── core/
│   └── types.ts         # TypeScript接口
├── state/
│   └── gameState.ts     # 状态初始化和管理
├── systems/
│   ├── probeSystem.ts       # 探测器发射和扫描
│   ├── resourceSystem.ts    # 资源生产
│   ├── exposureSystem.ts    # 暴露度衰减
│   ├── colonizationSystem.ts # 星球殖民
│   ├── strikeSystem.ts      # 打击发射和解算
│   └── aiSystem.ts          # AI决策
├── render/
│   └── renderer.ts      # 画布渲染
├── ui/
│   └── uiManager.ts     # UI面板管理
├── i18n/
│   └── translations.ts  # 多语言翻译
└── main.ts              # 游戏循环和入口点
```

## 🎨 游戏常量

关键参数（可在 `src/constants.ts` 中编辑）：

- **时刻间隔**：800毫秒
- **初始资源**：100能量，50材料，20算力
- **脉冲探测器**：10能量，150范围，3时刻，+5暴露度
- **深度探测器**：50能量，300范围，8时刻，+20暴露度
- **殖民**：50能量 + 30材料，+15暴露度
- **打击**：80能量 + 40材料，10时刻飞行，+30暴露度
- **暴露度衰减**：每时刻0.5

## 🔧 技术栈

- **TypeScript** - 类型安全的游戏逻辑
- **HTML5 Canvas** - 星图渲染
- **Vite** - 快速开发和构建
- **原生ES模块** - 无复杂打包器配置

## 📝 待办事项 / 未来改进

- [ ] 保存/加载游戏状态
- [ ] 科技树实现（效率升级）
- [ ] 地图缩放和平移控制
- [ ] 更多星球类型和特殊资源
- [ ] 胜利条件（生存时间、殖民地数量）
- [ ] 难度级别
- [ ] 更好的AI寻路和策略
- [ ] 动画改进（探测器波、打击轨迹）
- [ ] 音效（可选）

## 🎮 游戏截图

### 初始游戏状态
![初始状态](https://github.com/user-attachments/assets/21a31978-ba54-4d72-ba42-aa0b8128c31b)
*游戏开始时，你从一个绿色殖民地开始，周围是未知的灰色星球*

### 脉冲扫描后
![扫描后](https://github.com/user-attachments/assets/65eb5649-b813-4eb7-b9d2-a9cab89c9ee1)
*发射脉冲扫描后，附近的星球被揭示，资源面板显示当前状态*

### 星球交互
![星球弹窗](https://github.com/user-attachments/assets/80ec08c5-ba5a-4d6a-9e03-29f388ffe8fc)
*点击星球打开详细信息弹窗，可以选择殖民或打击*

### 游戏结束
![游戏结束](https://github.com/user-attachments/assets/acf1de9c-4606-4c2e-b8b6-6e4719960ab3)
*失去所有殖民地后游戏结束*

### 资源管理
*通过殖民多个星球来增加资源产量，但要注意暴露度的增长*

### 殖民扩张
*成功殖民的星球会变成绿色，为你提供持续的资源收入*

### 战略打击
*对敌对AI发起打击需要谨慎计划，因为这会大幅增加你的暴露度*

### 中期游戏
*管理多个殖民地，平衡资源产出与暴露度，同时防御AI的攻击*

## 📜 许可证

MIT

## 🙏 致谢

灵感来自刘慈欣的《三体》三部曲和黑暗森林理论。

---

## 🌟 游戏机制详解

### 暴露度机制
暴露度是游戏的核心机制：
- 每个殖民地产生基础暴露度
- 发射探测器增加暴露度
- 发射打击大幅增加暴露度
- 暴露度每时刻自然衰减
- AI会根据你的暴露度决定是否攻击你

### 情报与探索
游戏采用4层情报系统：
1. **未知**：只显示星球位置
2. **已知**：显示基本信息
3. **已扫描**：显示资源产量
4. **已分析**：显示所有详细信息

### 资源平衡
三种资源各有用途：
- **能量**：发射探测器和打击的主要消耗
- **材料**：殖民和打击的建设消耗
- **算力**：未来科技升级的预留资源

### AI行为
AI对手具有以下特性：
- 基于暴露度检测玩家
- 有不同的侵略性等级
- 会扩张自己的势力
- 会对高暴露度目标发起攻击
